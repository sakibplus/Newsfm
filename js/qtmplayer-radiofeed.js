!function(e){"use strict";e.qtmplayerRadioFeedObj={body:e("body"),window:e(window),document:e(document),htmlAndbody:e("html,body"),qtFeedData:{},timeInterval:15e3,fn:{cachedThumbsArray:[],getThumbnail:function(t,a,o){var r,n=a.split("\x3c!--");n.length>1&&(a=n[0]);var i="https://itunes.apple.com/search?term="+(a=a.split(" - ").join("-").split(" ").join("+"));if("Song title unavailable"==a||"No Titles Available"==a)return r=e.qtmplayerRadioFeedObj.qtFeedData.cover,t.cachedThumbsArray[a]=r,void o(r);void 0===t.cachedThumbsArray[a]?e.qtmplayerRadioFeedObj.qtFeedData.artwork?(a=a.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,""),o(e.qtmplayerRadioFeedObj.qtFeedData.artwork+"?song="+a)):e.ajax({type:"GET",cache:!0,url:i,async:!0,dataType:"jsonp",context:this,success:function(e){if("object"!=typeof e&&(e=JSON.parse(e)),e.resultCount>0)return r=e.results[0].artworkUrl100.split("100x100bb.jpg").join("1000x1000bb.jpg"),t.cachedThumbsArray[a]=r,void o(r)}}):o(t.cachedThumbsArray[a])},marqueeInstances:[],marqueeText:function(t){if("function"==typeof e.fn.marquee){var a=e("body").find(".proradio-marquee");if(t.marqueeInstances.length>0){for(var o=0;o<t.marqueeInstances.length;o++)void 0!==t.marqueeInstances[o]&&t.marqueeInstances[o].marquee("destroy");t.marqueeInstances=[]}e.each(a,(function(a,o){var r=e(o);0===r.find(".marquee").length&&r.html('<span class="marquee">'+r.html()+"</span>"),r.outerWidth()>r.find(".marquee").outerWidth()||(t.marqueeInstances[a]=r.marquee({duration:2e4,gap:150,delayBeforeStart:0,direction:"left",duplicated:!0,pauseOnCycle:0,startVisible:!0}))}))}},qtApplyListeners:function(t,a){if((e.qtmplayerRadioFeedObj.qtFeedData.listeners||e.qtmplayerRadioFeedObj.qtFeedData.listenerspeak)&&(t||a))return e(".qtmplayer__stats").addClass("show"),t&&e.qtmplayerRadioFeedObj.qtFeedData.listeners?(e(".qtmplayer-listeners span").html(t),e(".qtmplayer-listeners").show()):e(".qtmplayer-listeners").hide(),a&&e.qtmplayerRadioFeedObj.qtFeedData.listenerspeak?(e(".qtmplayer-listener_peak span").html(a),e(".qtmplayer-listener_peak").show()):e(".qtmplayer-listener_peak").hide(),!0;e(".qtmplayer__stats").removeClass("show"),e(".qtmplayer-listeners span").html(""),e(".qtmplayer-listener_peak span").html("")},qtApplyTitle:function(t,a){var o=this;if(t&&""!==t){var r=">>>>> qtApplyTitle : "+t;e.qtmplayerRadioFeedObj.fn.log(r);var n,i,l=t.split(" - ");l.length>1||(l=t.split("-")).length>1?(n=l[0],i=l[1]):(n="",i=t);var s=n.split("[");s.length>1&&(n=s[0]),(s=n.split(" : ")).length>1&&(n=s[1]);var c=i.split("[");c.length>1&&(i=c[0]),i=e.trim(i),n=e.trim(n),e(".qtmplayer-feed").show(),e(".qtmplayer__title").html(i),e(".qtmplayer__artist").html(n),o.marqueeText(o);var p=n+"-"+i;if(a&&this.getThumbnail(o,p,a),window.screen.width<670){var d=navigator.userAgent||navigator.vendor||window.opera;/Googlebot/i.test(d)||/Bing/i.test(d)||/Yandex/i.test(d)||/Apple Bot/i.test(d)||/DuckDuck Bot/i.test(d)||jQuery(document).prop("title",n+" - "+i)}}else e(".qtmplayer-feed").hide()},newFeedReading:function(){e.qtmplayerRadioFeedObj.fn.log("newFeedReading = REITERATE - "+e.now());var t,a=e.qtmplayerRadioFeedObj,o=a.qtFeedData,r=o.callBack,n=a.fn,i=void 0!==o.host?o.host:"",l=void 0!==o.port?o.port:"",s=void 0!==o.protocol?o.protocol:"http",c=void 0!==o.channel?o.channel:"",p=void 0!==o.icecasturl?o.icecasturl:"",d=void 0!==o.icecastmountpoint?o.icecastmountpoint:"",y=void 0!==o.icecastchannel?o.icecastchannel:"",u=void 0!==o.radiodotco?o.radiodotco:"",f=void 0!==o.airtime?o.airtime:"",m=void 0!==o.radionomy?o.radionomy:"",q=void 0!==o.textfeed?o.textfeed:"",g=void 0!==o.useproxy?o.useproxy:"",h=void 0!==o.live365?o.live365:"",v=void 0!==o.radioking?o.radioking:"",T=void 0!==o.azuracast?o.azuracast:"",j=void 0!==o.securesystems?o.securesystems:"",b=void 0!==o.radiojar?o.radiojar:"",w=void 0!==o.radioboss?o.radioboss:"",x=void 0!==o.maxcast?o.maxcast:"",F=void 0!==o.sonicpanel?o.sonicpanel:"",E=void 0!==o.sonicpaneldj?o.sonicpaneldj:"",A=void 0!==o.jazler?o.jazler:"",O=void 0!==o.streamerr?o.streamerr:"";e("#qtFeedPlayerTrack"),e("#qtFeedPlayerAuthor"),e("#qtPlayerTrackInfo");a=e.qtmplayerRadioFeedObj;var R=e("#qtmplayer-radiofeed-proxyurl").data("proxyurl"),k=(new Date).getUTCMilliseconds(),S=!1,_=!1;if("type-mediacp"==o.servertype)return n.log(qtmediacp),g&&(qtmediacp=R+"?qtproxycall="+window.btoa(qtmediacp)),void e.ajax({type:"GET",cache:!1,url:qtmediacp,async:!0,jsonp:!0,success:function(e){"object"!=typeof e&&(e=JSON.parse(e)),n.log(e),D=e.nowplaying,e.coverart&&"function"==typeof r&&(r(e.coverart),r=!1),n.qtApplyTitle(D,r)},error:function(e){console.log("MediaCP feed not loaded - error ahead:"),console.log(e)}});if("type-streamerr"==o.servertype)return n.log(O),g&&(O=R+"?qtproxycall="+window.btoa(O)),void e.ajax({type:"GET",cache:!1,url:O,async:!0,jsonp:!0,success:function(e){"object"!=typeof e&&(e=JSON.parse(e)),n.log(e),D=e.nowplaying,e.coverart&&"function"==typeof r&&(r(e.coverart),r=!1),n.qtApplyTitle(D,r)},error:function(e){console.log("Streamerr not working - error ahead:"),console.log(e)}});if("type-sonicpanel"==o.servertype&&""!==F&&(F=F.indexOf("?")>-1?F+"&rand="+k:F+"?rand="+k,g&&(F=R+"?qtproxycall="+window.btoa(F)),e.ajax({type:"GET",cache:!1,url:F,async:!0,success:function(e){"object"!=typeof e&&(e=JSON.parse(e));var t="Now live - Streaming";e.title&&(t=e.title,e.artist&&(t=e.artist+" - "+e.title)),e.art&&"function"==typeof r&&(e.title&&(e.art=e.art+"?title="+e.title.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"")),r(e.art),r=!1),e.thumb&&"function"==typeof r&&(r(e.thumb+"#.jpg"),r=!1),"1"==E&&"No DJ"!==e.djusername&&(t=e.title.split(" - ").join(" / ")+" - "+e.djusername),e.listn&&(_=e.listn),e.peaklistn&&(S=e.peaklistn),n.qtApplyListeners(_,S),n.qtApplyTitle(t,r)},error:function(e){console.log(e)}})),"type-jazler"==o.servertype){var I=A.split("NowOnAir.xml").join("AlbumsCache/");return g&&(A=R+"?qtproxycall="+window.btoa(A)),n.log("=============================================================="),n.log(A),void e.ajax({type:"GET",url:A,dataType:"xml",async:!0,cache:!1,success:function(t){n.log(t),e(t).find("Event").each((function(){n.log(e(this));var t=e(this).find("CacheImageFile").html();e(this).find("Announcement").each((function(){var a=e(this).attr("Display");n.log(a),t&&"function"==typeof r&&(n.log(I+t),r(I+t),r=!1),n.qtApplyTitle(a,r)}))}))},error:function(e){console.log("Jazler source unreachable - please check your channel settings"),console.log(e)}})}if("type-lautfm"!=o.servertype)if("type-icy"===o.servertype&&(n.log("type-icy"),n.log(R+"?qtproxycall="+window.btoa(o.file)+"&icymetadata=1"),e.ajax({type:"GET",url:R,jsonpCallback:"parseMusic",async:!0,cache:!1,data:{qtproxycall:window.btoa(o.file),icymetadata:"1"},success:function(t){if("Song title unavailable"===t||"Cannot open the stream"===t)return n.log("ERROR OPENING THE STREAM OR GETTING THE TITLES: "+t),n.qtApplyTitle(e.qtmplayerRadioFeedObj.qtFeedData.title,!1),void r(e.qtmplayerRadioFeedObj.qtFeedData.cover);n.qtApplyTitle(t,r),n.log(t)},error:function(e){console.log("Error"),n.log(e),console.log(e)}})),"type-auto"!=o.servertype){if("type-maxcast"==o.servertype)return n.log("Maxcast "+x),x=x+"?rand="+k,g&&(x=R+"?qtproxycall="+window.btoa(x)),void e.ajax({type:"GET",cache:!1,url:x,async:!0,jsonpCallback:"parseMusic",jsonp:!1,data:C,success:function(e){"object"!=typeof e&&(e=JSON.parse(e)),e.playing&&(D=e.playing.current),e.song_data&&"function"==typeof r&&(r(e.song_data.cover),r=!1),n.qtApplyTitle(D,r)},error:function(e){console.log(e)}});if(""!==w||""!==j||""!==b||""!==v||""!==T||""!==q||""!==m||""!==h||""!==f||""!==i&&""!==l&&void 0!==i||""!==p||""!==u){if(""!==w)return w=w,n.log(w),g&&(w=R+"?qtproxycall="+window.btoa(w)),void e.ajax({type:"GET",cache:!1,url:w,async:!0,success:function(e){"object"!=typeof e&&(e=JSON.parse(e)),D=e.nowplaying,n.qtApplyTitle(D,r)},error:function(e){console.log(e)}});if(""!==b&&(b=b.indexOf("?")>-1?b+"&rand="+k:b+"?rand="+k,g&&(b=R+"?qtproxycall="+window.btoa(b)),e.ajax({type:"GET",cache:!1,url:b,async:!0,success:function(e){"object"!=typeof e&&(e=JSON.parse(e));var t="Now live - Streaming";e.title&&(t=e.title,e.artist&&(t=e.artist+" - "+e.title)),e.art&&"function"==typeof r&&(e.title&&(e.art=e.art+"?title="+e.title.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"")),r(e.art),r=!1),e.thumb&&"function"==typeof r&&(r(e.thumb+"#.jpg"),r=!1),n.qtApplyTitle(t,r)},error:function(e){console.log(e)}})),""!==j)return j=j,g&&(j=R+"?qtproxycall="+window.btoa(j)),void e.ajax({type:"GET",cache:!1,url:j,async:!0,dataType:"xml",success:function(t){e(t).find("cover").length>0&&""!==e(t).find("cover").html()&&"function"==typeof r&&(r(e(t).find("cover").html()),r=!1);var a=e(t).find("title").html();void 0!==a&&"undefined"!=a||(a=e(t).find("name").html()),n.qtApplyTitle(e(t).find("artist").html()+" - "+a,r)},error:function(e){console.log(e)}});if(""!==h)h="https://api.live365.com/station/"+h,g&&(h=R+"?qtproxycall="+window.btoa(h)),e.ajax({type:"GET",cache:!1,url:h,async:!0,jsonpCallback:"parseMusic",jsonp:!1,success:function(e){if(e,"object"!=typeof e&&(e=JSON.parse(e)),e["current-track"].art){var t=e["current-track"].art;""!=t&&(r(t),r=!1)}n.qtApplyTitle(e["current-track"].artist+" - "+e["current-track"].title,r)},error:function(e){console.log(e)}});else{var N,G;if(""!==q)return g?(N=e("#qtmplayer-radiofeed-proxyurl").data("proxyurl"),G={qtproxycall:window.btoa(q)}):N=q,void e.ajax({type:"GET",cache:!1,url:N,async:!0,data:G,dataType:"html",success:function(e){n.qtApplyTitle(e,r)},error:function(e){console.log(e)}});if(""!==m)e.ajax({type:"GET",url:m,async:!0,cache:!1,dataType:"xml",success:function(t){n.qtApplyTitle(e(t).find("artists").html()+" - "+e(t).find("title").html())},error:function(e){console.log(e)}});else if(""!==f&&"undefined"!==f&&void 0!==f&&void 0!==f){e.ajax({type:"GET",cache:!1,url:f,async:!0,data:{qtproxycall:window.btoa(f)},jsonpCallback:"parseMusic",jsonp:!0,success:function(e){"object"!=typeof e&&(e=JSON.parse(e)),D=e.tracks.current.name,n.qtApplyTitle(D)},error:function(e){}})}else if(""!==p&&void 0!==p){var L,D,C,M=p;_=!1,S=!1;g&&(M=R,C={qtproxycall:window.btoa(p)}),n.log("Radio feed - Icecast "+p),e.ajax({type:"GET",cache:!1,url:M,async:!0,jsonpCallback:"parseMusic",jsonp:!1,data:C,success:function(t){n.log("Ajax response"),n.log(t),"object"!=typeof t&&(t=JSON.parse(t)),void 0===t.icestats?d?L=t[d]:e.each(t,(function(e,t){L=t,0==e&&(L=t)})):L=t.icestats.source,void 0!==L&&(d&&(L=L[d]),y&&(L=L[y]),y||void 0!==L.title||(L=L[0]),D=L.title,L.artist&&(D=D+" - "+L.artist),n.qtApplyTitle(D,r),L.listeners&&(_=L.listeners),L.listener_peak&&(S=L.listener_peak),n.qtApplyListeners(_,S))},error:function(e){console.log(e),n.log("Ajax response"),n.log(e)}})}else{if(""!==i&&""!==l&&void 0!==i){var P={shoutcast_host:i,shoutcast_port:l,shoutcast_protocol:s,shoutcast_channel:c},J="http";"443"!==P.shoutcast_port&&"https"!==P.shoutcast_protocol||(J="https");var U=J+"://"+P.shoutcast_host+":"+P.shoutcast_port+"/stats?sid="+(P.shoutcast_channel||1)+"&json=1";M=U;g&&(M=R,C={qtproxycall:window.btoa(U)});try{e.ajax({type:"GET",cache:!1,url:M,async:!0,data:C,dataType:e.qtmplayerRadioFeedObj.qtFeedData.dataType,contentType:"application/json",success:function(e){"object"!=typeof e&&(e=JSON.parse(e)),n.qtApplyTitle(e.songtitle,r),e.currentlisteners&&(_=e.currentlisteners),e.peaklisteners&&(S=e.peaklisteners),n.qtApplyListeners(_,S)},error:function(t){"jsonp"!==e.qtmplayerRadioFeedObj.qtFeedData.dataType&&(e.qtmplayerRadioFeedObj.qtFeedData.dataType="jsonp",e.qtmplayerRadioFeedObj.fn.newFeedReading())}})}catch(e){dataType="jsonp",console.log(e)}return}if(""!==u&&void 0!==u){var z="https://public.radio.co/stations/"+u+"/status";e.ajax({type:"GET",cache:!1,url:z,async:!0,contentType:"application/json",success:function(e){if(e.current_track){if(D=e.current_track.title,n.log("Radio.co artwork: "+e.current_track.artwork_url_large),e.current_track.artwork_url_large&&"function"==typeof r){var t=e.current_track.artwork_url_large;""!==t&&(r(t),r=!1)}}else D="Song title currently unavailable - Please check your radio settings";n.qtApplyTitle(D,r)},error:function(e){}})}else if("type-radioking"==o.servertype&&""!==v){z="https://api.radioking.io/widget/radio/"+v+"/track/current";e.ajax({type:"GET",cache:!1,url:z,async:!0,contentType:"application/json",success:function(e){D=e.artist+" - "+e.title,e.cover&&"function"==typeof r&&(r(e.cover),r=!1),n.qtApplyTitle(D,r)},error:function(e){console.log(e)}})}else if("type-azuracast"==o.servertype&&""!==T){z="",M=T+"?rand="+k;g&&(M=R+"?qtproxycall="+window.btoa(T)),e.ajax({type:"GET",cache:!1,url:M,async:!0,contentType:"application/json",success:function(e){"string"==typeof e&&(e=jQuery.parseJSON(e)),void 0===e.now_playing&&(e=e[0]),t=e.now_playing.song.artist,D=e.now_playing.song.title,""!==t&&(D=t+" - "+D),e.now_playing.song.cover&&"function"==typeof r&&(r(e.now_playing.song.cover),r=!1),e.now_playing.song.art&&"function"==typeof r&&(r(e.now_playing.song.art),r=!1),e.cover&&"function"==typeof r&&(r(e.cover),r=!1),e.art&&"function"==typeof r&&(r(e.art),r=!1),e.listeners&&(e.listeners.current&&(_=e.listeners.current),e.listeners.total&&(S=e.listeners.total),n.qtApplyListeners(_,S)),n.qtApplyTitle(D,r)},error:function(e){console.log(e)}})}}}}else n.qtApplyTitle()}else-1!=o.file.indexOf("/proxy/")&&-1!=o.file.indexOf("https")&&-1!=o.file.indexOf("?mp=/")?(n.log("type-auto TYPE 1 - GET MOUNTPOINT"),i=(i=o.file.split("?mp=/"))[0]+"?mp=/stats&rand="+k,g&&(i=R+"?qtproxycall="+window.btoa(i)),e.ajax({type:"GET",url:i,async:!0,cache:!1,dataType:"xml",success:function(t){n.qtApplyTitle(e(t).find("SONGTITLE").html(),r),e(t).find("CURRENTLISTENERS")&&(_=e(t).find("CURRENTLISTENERS").html()),e(t).find("PEAKLISTENERS")&&(S=e(t).find("PEAKLISTENERS").html()),n.qtApplyListeners(_,S)},error:function(e){n.log(e),console.log(e)}})):-1==o.file.indexOf("/proxy/")&&-1!=o.file.indexOf("https")&&o.file.endsWith("/stream")&&-1==o.file.indexOf("/mp3")?(n.log("type-auto TYPE 2 - XML:"+o.file.endsWith("/stream")+"? ----\x3e "+o.file),i=o.file.replace(/\/stream$/,"/stats","$1"),n.log('Stats link: <a href="'+i+'">'+i+"</a>"),g&&(i=R+"?qtproxycall="+window.btoa(i)),n.log('Proxy stats link: <a href="'+i+'">'+i+"</a>"),e.ajax({type:"GET",url:i,async:!0,success:function(t){if("Song title unavailable"===t)return n.qtApplyTitle(e.qtmplayerRadioFeedObj.qtFeedData.title,!1),void r(e.qtmplayerRadioFeedObj.qtFeedData.cover);n.qtApplyTitle(e(t).find("SONGTITLE").html(),r),e(t).find("CURRENTLISTENERS")&&(_=e(t).find("CURRENTLISTENERS").html()),e(t).find("PEAKLISTENERS")&&(S=e(t).find("PEAKLISTENERS").html()),n.qtApplyListeners(_,S)},error:function(e){n.log(e),console.log(e)}})):(n.log("type-auto TYPE 3 ICY METADATA"),n.log(R+"?qtproxycall="+window.btoa(o.file)+"&icymetadata=1"),e.ajax({type:"GET",url:R,jsonpCallback:"parseMusic",async:!0,cache:!1,data:{qtproxycall:window.btoa(o.file),icymetadata:"1"},success:function(t){if("Song title unavailable"===t)return n.qtApplyTitle(e.qtmplayerRadioFeedObj.qtFeedData.title,!1),void r(e.qtmplayerRadioFeedObj.qtFeedData.cover);n.qtApplyTitle(t,r),n.log(t)}}));else if(n.log("Server type: LAUT.FM"),n.log("Stream URL: "+o.file),-1!=o.file.indexOf("/stream.laut.fm/")){n.log("Laut.FM reading titles");var B="https://api.laut.fm/station/"+o.file.split("https").join("http").split("http://stream.laut.fm/").join("")+"/current_song";g&&(B=R+"/?qtproxycall="+window.btoa(B)),e.ajax({type:"GET",url:B,async:!0,cache:!1,success:function(e){n.log("Laut.FM Success"),"object"!=typeof e&&(e=JSON.parse(e));var t="Now live - Streaming";e.type&&"jingle"!==e.type&&(e.title&&(t=e.title,e.artist&&e.artist.name&&(t=e.artist.name+" - "+t)),n.qtApplyTitle(t,r))},error:function(e){n.log(e),console.log(e),n.qtApplyTitle("Laut FM API error - Titles not available")}})}},feedInterval:null,stopFeed:function(){e.qtmplayerRadioFeedObj;void 0!==e.qtmplayerRadioFeedObj.fn.qtFeedInterval&&clearInterval(e.qtmplayerRadioFeedObj.fn.qtFeedInterval)},pushFeed:function(t){var a=e.qtmplayerRadioFeedObj;a.qtFeedData=t,a.fn.log("pushFeed = INITIALIZE"+e.now()),a.fn.log(t),a.fn.stopFeed(),a.fn.newFeedReading(),a.fn.qtApplyListeners(!1,!1),e.qtmplayerRadioFeedObj.qtFeedData.dataType="",e.qtmplayerRadioFeedObj.fn.qtFeedInterval=setInterval((function(){a.fn.newFeedReading()}),e.qtmplayerRadioFeedObj.timeInterval)},log:function(t){var a=e("#qtmPlayerDebugger");a.length>0&&a.append(t+"<br>")}}},e(document).ready((function(){e.qtmplayerRadioFeedObj.fn.qtApplyTitle()}))}(jQuery);